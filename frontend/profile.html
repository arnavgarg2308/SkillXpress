<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SkillNest | Profiles</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body{background:linear-gradient(135deg,#f0f4ff,#ffffff);min-height:100vh;display:flex;align-items:center}
.card{border-radius:22px;box-shadow:0 20px 40px rgba(0,0,0,.08)}
.btn-main{background:#4f46e5;color:#fff;font-weight:600;border-radius:12px}
</style>
</head>
<body>
<div class="container">
<div class="row justify-content-center">
<div class="col-lg-5">
<div class="card p-4">
<h4 class="fw-bold"> Your Profile</h4>
<input id="username" class="form-control my-2" placeholder="Username">
<input id="college" class="form-control my-2" placeholder="College">
<input id="course" class="form-control my-2" placeholder="Course">
<input id="branch" class="form-control my-2" placeholder="Branch">
<input id="year" class="form-control my-2" placeholder="Year">
<input id="age" class="form-control my-2" placeholder="Age">
<input id="github" class="form-control my-2" placeholder="GitHub URL">
<input id="leetcode" class="form-control my-2" placeholder="LeetCode URL">
<input id="codechef"class="form-control my-2" placeholder="CodeChef URL">
<input id="hackerrank" class="form-control my-2" placeholder="HackerRank URL">
<button class="btn btn-main w-100 mt-3" onclick="saveLinks()">Save & Continue</button>
</div>
</div>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="auth.js"></script>
<script>
async function saveLinks() {
  // 1. session check
  const { data: { session } } = await supabaseClient.auth.getSession();

  if (!session) {
    alert("Please login again");
    window.location.href = "index.html";
    return;
  }

  const user = session.user;
const username = document.getElementById("username")?.value || null;
  const college = document.getElementById("college")?.value || null;
  const course = document.getElementById("course")?.value || null;
  const branch = document.getElementById("branch")?.value || null;
  const year = document.getElementById("year")?.value || null;
  const age = document.getElementById("age")?.value || null;

  // 2. input values
  const github = document.getElementById("github").value;
  const leetcode = document.getElementById("leetcode").value;
  const codechef = document.getElementById("codechef").value;
  const hackerrank = document.getElementById("hackerrank").value;

  // 3. update DB
  const { error } = await supabaseClient
    .upsert({
  id: user.id,
  username,
  college,
  course,
  branch,
  year,
  age,
  github,
  leetcode,
  codechef,
  hackerrank,
  is_profile_completed: true
}, {
  onConflict: 'id'
});
  if (error) {
    console.error(error);
    alert("Failed to save profile links");
    return;
  }

  // 4. next page
  window.location.href = "interests.html";
}
</script>

</body>
</html>